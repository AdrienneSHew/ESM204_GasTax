---
title: "Gas Tax Assignment"
author: "Daphne Virlar"
date: "4/25/2019"
output: html_document
theme: yeti
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
gt_data <- read_csv("Gas_Data.csv")

```


```{r, problem1}
#What is the aggregate daily demand curve for gasoline in France? 

#Create a linear model that explains how price is influenced by demand 
    #Creating a linear model to give you the equation of the line.
low_demand_lm <- lm(gt_data$Price_Dollars ~ gt_data$Q_Low_Gallons_per_Day)
high_demand_lm <- lm(gt_data$Price_Dollars ~ gt_data$Q_High_Gallons_per_Day)

summary(low_demand_lm)        #p = alpha + beta*Q
  alpha_low <- 2.199e+01
  beta_low  <- -1.355e-04
  
  
summary(high_demand_lm)      #p = alpha + beta*Q  
  alpha_high <- 2.339e+01
  beta_high  <- -1.297e-04


Q_low1 <- (1/beta_low)
Q_low2 <- (alpha_low/-beta_low)
  #Qlow = q_low1*P + q_low2

Q_high1 <- (1/beta_high)
Q_high2 <- (alpha_high/-beta_high)
  #Qhigh = q_high1*P + q_high2

Q_agg1 <- Q_low1 + Q_high1
Q_agg2 <- Q_low2 + Q_high2

P_agg1 <- 1/Q_agg1
P_agg2 <- -Q_agg2/Q_agg1

#Finding the supply curve
sup_curve <- 5/((5-P_agg2)/P_agg1)

#####################################################################################################
                                          # FUNCTIONS #
q_low <- function(x){
  alpha_low + beta_low*x
}

q_high <- function(x){
  alpha_high + beta_high*x
}

p_agg <- function(x){
  P_agg2 + P_agg1*x 
}

supply <- function(x){
  sup_curve*x
}

mec <- function(x){
  2
}


#####################################################################################################
#data frame to create P-optimum and Q-Optimum point on the graph
#df <- data.frame(x = 0:267176.2, y = 5)


ggplot(data.frame(x = c(70000, 500000)), aes(x = x)) +    #the x variable just allows for all the large numbers to actually show up on the graph. Otherwise it looks like a  bunch of flat lines.
  stat_function(fun = q_low, color = "cadetblue3") +
  stat_function(fun = q_high, color = "red3") +
  stat_function(fun = p_agg, color = "mediumpurple")+
  stat_function(fun = supply, color = "olivedrab")+
  stat_function(fun = mec, color = "orange")+
  xlab("\nQuantity") + ylab("Price\n") + ggtitle("Problem 1: Initial Gas Tax Set-Up \n") +
  scale_y_continuous(limits= c(0,25), expand = c(0,0)) +  # set the y-axis
  scale_x_continuous(limits= c(0, 500000), expand = c(0,0)) # set x-axis

  

#######################################################################################################

#Calculating Low Consumer Surplus
base_low <- 125387.5
height_low <- 162282.8
cons_surp_low <- (1/2)*base_low*height_low






        

```



Tricks of the trade: Page Break. When knitting to html, page break will only appear whe you try to print or print to pdf. 
<P style="page-break-before: always">

```{r, echo=FALSE}

```

